<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>&#x202A;BerndoKeyboard-Firmware: &#x202A;Platform Hardware Information</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">&#x202A;BerndoKeyboard-Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc PageDocLTR-title"><div class="header">
  <div class="headertitle">
<div class="title">&#x202A;Platform Hardware Information </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="DocNodeLTR"><a class="anchor" id="autotoc_md0"></a>
Brief</h1>
<p class="DocNodeLTR">This page contains information about the hardware platform this software (firmware) will run on. The firmware itself runs on a STM32F103RET6 microcontroller, containing an ARM Cortex-M3 processor core. This chip is implemented on an IntelliModule-Alpha controller board, which plugs into the main PCB of the platform. The main PCB is a backplane connecting the keyboard switches together into a matrix. This matrix is read by the firmware and sent to the USB host.</p>
<h1 class="DocNodeLTR"><a class="anchor" id="autotoc_md1"></a>
Interfaces</h1>
<h2 class="DocNodeLTR"><a class="anchor" id="autotoc_md2"></a>
I2C</h2>
<ul class="DocNodeLTR">
<li>&#x202A;<b>I2C1</b><br  />
 Used for communication between the main microcontroller and the I2C port expander chips which control the probe-lines of the keyboard matrix. The connected devices are listed below:<ul class="DocNodeLTR">
<li>&#x202A;<b>PORTEX_0</b><br  />
 <em>Device: PCA9555PW,118</em><br  />
 <em>I2C-Bus Address: <code>0x20</code></em><br  />
 This device connects to the keyboard matrix probe lines 0 to 15.<br  />
 The following table shows the connections of the port expander: <table class="DocNodeLTR" class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">&#x202A;Port Expander IO </th><th class="markdownTableHeadLeft">&#x202A;Signal  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_0 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_0  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_1 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_2 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_3 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_4 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_5 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_5  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_6 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_6  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_7 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_7  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_0 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_8  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_1 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_9  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_2 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_10  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_3 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_11  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_4 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_12  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_5 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_13  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_6 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_14  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_7 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_15  </td></tr>
</table>
</li>
<li>&#x202A;<b>PORTEX_1</b><br  />
 <em>Device: PCA9555PW,118</em><br  />
 <em>I2C-Bus Address: <code>0x21</code></em><br  />
 This device connects to the keyboard matrix probe lines 16 to 21.<br  />
 The following table shows the connections of the port expander: <table class="DocNodeLTR" class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">&#x202A;Port Expander IO </th><th class="markdownTableHeadLeft">&#x202A;Signal  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_0 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_16  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_1 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_17  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_2 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_18  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_3 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_19  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_4 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_20  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_5 </td><td class="markdownTableBodyLeft">&#x202A;KBM_PROBE_21  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO0_6 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO0_7 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_0 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_1 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_2 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_3 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_4 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_5 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;IO1_6 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;IO1_7 </td><td class="markdownTableBodyLeft">&#x202A;<em>Not Connected</em>  </td></tr>
</table>
</li>
<li>&#x202A;<b>EEPROM_0</b><br  />
 <em>Device: CAT24C512WI-GT3</em><br  />
 <em>Size: 512kb (64k x 8) (64kByte)</em><br  />
 <em>I2C-Bus Address: <code>0x50</code></em><br  />
 This device sits on the IntelliModule-Alpha controller board and is a general-purpose EEPROM. It is used to save the keyboard matrix configuration.</li>
</ul>
</li>
</ul>
<h2 class="DocNodeLTR"><a class="anchor" id="autotoc_md3"></a>
U(S)ART</h2>
<ul class="DocNodeLTR">
<li>&#x202A;<b>USART1</b><br  />
 Used as a serial debug connection port. This port directly connects to the debug header and is used by the firmware to output debug messages. This port is configured to use the baud rate 115200 by default.</li>
</ul>
<h1 class="DocNodeLTR"><a class="anchor" id="autotoc_md4"></a>
GPIOs</h1>
<p class="DocNodeLTR">The following table shows the hardware-mapping of the processor's GPIO pins/ports:</p>
<table class="DocNodeLTR" class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">&#x202A;Pin Name </th><th class="markdownTableHeadLeft">&#x202A;Direction </th><th class="markdownTableHeadLeft">&#x202A;Pull-Resistor Config </th><th class="markdownTableHeadLeft">&#x202A;Signal  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PC12 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_0  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PC11 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PC10 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PC9 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PC8 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PC4 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_5  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PC5 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;KBM_DATA_6  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PC7 </td><td class="markdownTableBodyLeft">&#x202A;Output (PWM) </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;LED_DATA_IN  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PD2 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;PROBE_PORT_EXP_INTn  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PB0 </td><td class="markdownTableBodyLeft">&#x202A;Output </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;USER_LED_0  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PB1 </td><td class="markdownTableBodyLeft">&#x202A;Output </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;USER_LED_1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PB2 </td><td class="markdownTableBodyLeft">&#x202A;Output </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;USER_LED_2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PA4 </td><td class="markdownTableBodyLeft">&#x202A;Output </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;ERROR_LED  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PA8 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;HWBIT0  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PB8 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;HWBIT1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PB9 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;HWBIT2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PB12 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;HWBIT3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">&#x202A;PC6 </td><td class="markdownTableBodyLeft">&#x202A;Input </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;HWBIT4  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">&#x202A;PB5 </td><td class="markdownTableBodyLeft">&#x202A;Output </td><td class="markdownTableBodyLeft">&#x202A;None </td><td class="markdownTableBodyLeft">&#x202A;EEPROM_WP  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
